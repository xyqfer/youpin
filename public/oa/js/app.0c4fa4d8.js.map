{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?4199","webpack:///./src/App.vue?764d","webpack:///./src/utils/getSheetData.js","webpack:///./src/utils/getV.js","webpack:///./src/utils/formatSheet1.js","webpack:///./src/utils/formatSheet2.js","webpack:///./src/utils/updateDepartment.js","webpack:///./src/utils/generateUtils.js","webpack:///./src/utils/generateSheet1.js","webpack:///./src/utils/generateSheet2.js","webpack:///./src/utils/generateSheet.js","webpack:///./src/utils/save.js","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/plugins/element.js","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","app","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","Appvue_type_template_id_c943abd8_render","_vm","this","_h","$createElement","_c","_self","attrs","id","gutter","span","staticClass","slot","_v","type","size","placeholder","model","callback","$$v","dates","expression","staticStyle","margin-left","isCalcWorkDays","action","on-change","onUploadChange1","auto-upload","onUploadChange2","disabled","isProcessing","on","click","onStart","margin-top","downloadSummarySheet","downloadDepartmentSheet","_e","staticRenderFns","getSheetData","file","sheetIndex","Promise","resolve","reader","FileReader","onload","e","target","workbook","XLSX","read","sheetData","SheetNames","map","Sheets","readAsBinaryString","getV","w","formatTime","time","_time$trim$split","trim","split","_time$trim$split2","slicedToArray","hour","minite","parseInt","getLateData","_ref","date","workDates","includes","isLate","late","limit","lateTime","getOvertimeData","_ref2","isOvertime","subsidyTime","subsidyLimit","overtimeLimit","overtime","format","start","end","timeType","signIn","signOff","department","subsidy","workDays","rawLateTime","needWork","isWork","_getLateData","_getOvertimeData","subsidyPerDay","_subsidyTime","_subsidy","replace","group","getDepartment","getGroup","getDepartmentInfo","staffInfo","find","item","result2","result3","total","_getDepartmentInfo","count","createCurrentMonthData","today","Date","fullYear","getFullYear","year","toString","month","getMonth","fullMonth","concat","last","getDate","createLabelName","number","String","fromCharCode","generateSheet1","_createCurrentMonthDa","lastDay","sheet2LastLabel","generate","_objectSpread2","merges","wbData","wbData2","wbData3","departmentMerge","groupMerge","no","noIndex","generateSheet1Data","v","alignment","vertical","horizontal","note","entries","reduce","wrapText","generateSheet2Data","index","fill","fgColor","rgb","forEach","_ref3","_ref4","generateSheet3Data","key2","value2","timeLabel","rowName","sheet1Cols","wpx","汇总","objectSpread","!ref","!merges","!cols","A1","font","sz","A2","A3","明细","休病假","departmentSheet","_ref5","_ref6","groups","sheetName","obj","sheet","sheet1","generateSheet2","sheet4Merges","wbData4","techCount","generateSheet4Data","parseFloat","toFixed","_ref2$","color","sheet4Cols","Sheet1","N3","_generateSheet","sheet2","saveAs","fileName","a","document","createElement","download","href","URL","createObjectURL","setTimeout","revokeObjectURL","s2ab","buf","ArrayBuffer","view","Uint8Array","charCodeAt","save","_ref$name","_ref$data","zip","JSZip","workbookOut","write","bookType","bookSST","Blob","generateAsync","then","blob","err","console","log","Appvue_type_script_lang_js_","file1","file2","isFinish","methods","_this","all","utils_getSheetData","sheetData1","_ref2$2","sheetData2","data1","formatSheet1","data2","formatSheet2","_updateDepartment","updateDepartment","data3","generateSheet","$alert","confirmButtonText","fileList","raw","utils_save","src_Appvue_type_script_lang_js_","component","componentNormalizer","options","__file","App","Vue","use","Element","config","productionTip","render","h","$mount"],"mappings":"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","file":"js/app.0c4fa4d8.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/oa/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":8}},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"选择工作日期\")])]),_c('div',{staticClass:\"text item\"},[_c('el-date-picker',{attrs:{\"type\":\"dates\",\"size\":\"large\",\"placeholder\":\"选择工作日\"},model:{value:(_vm.dates),callback:function ($$v) {_vm.dates=$$v},expression:\"dates\"}}),_c('el-checkbox',{staticStyle:{\"margin-left\":\"20px\"},model:{value:(_vm.isCalcWorkDays),callback:function ($$v) {_vm.isCalcWorkDays=$$v},expression:\"isCalcWorkDays\"}},[_vm._v(\"显示全勤\")])],1)])],1),_c('el-col',{attrs:{\"span\":8}},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"上传报表\")])]),_c('div',{staticClass:\"text item\"},[_c('el-upload',{staticClass:\"upload-item\",attrs:{\"action\":\"\",\"on-change\":_vm.onUploadChange1,\"auto-upload\":false}},[_c('el-button',{attrs:{\"slot\":\"trigger\",\"size\":\"medium\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选取考勤报表（请确保后缀名是 xls）\")])],1),_c('el-upload',{staticClass:\"upload-item\",attrs:{\"action\":\"\",\"on-change\":_vm.onUploadChange2,\"auto-upload\":false}},[_c('el-button',{attrs:{\"slot\":\"trigger\",\"size\":\"medium\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选取员工花名册（请确保后缀名是 xlsx）\")])],1),_c('el-button',{attrs:{\"size\":\"medium\",\"type\":\"primary\",\"disabled\":_vm.isProcessing},on:{\"click\":_vm.onStart}},[_vm._v(\"开始生成\")]),(_vm.isFinish)?_c('div',{staticStyle:{\"margin-top\":\"60px\"}},[_c('el-button',{attrs:{\"size\":\"medium\",\"type\":\"primary\"},on:{\"click\":_vm.downloadSummarySheet}},[_vm._v(\"下载总表\")]),_c('el-button',{attrs:{\"size\":\"medium\",\"type\":\"primary\"},on:{\"click\":_vm.downloadDepartmentSheet}},[_vm._v(\"下载部门表\")])],1):_vm._e()],1)])],1),_c('el-col',{attrs:{\"span\":8}},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"注意事项\")])]),_c('div',{staticClass:\"text item\"},[_vm._v(\"\\n          1、检查数据正确性\\n        \")]),_c('div',{staticClass:\"text item\"},[_vm._v(\"\\n          2、修改时间\\n        \")])])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const getSheetData = (file, sheetIndex) => {\n  return new Promise((resolve) => {\n    let reader = new FileReader()\n    reader.onload = (e) => {\n      let data = e.target.result\n      let workbook = XLSX.read(data, { type: 'binary' })\n      let sheetData = workbook.SheetNames.map(name => {\n        return workbook.Sheets[name]\n      })\n\n      resolve(sheetData)\n    }\n    reader.readAsBinaryString(file)\n  })\n}\n\nexport default getSheetData\n","const getV = data => {\n  return data ? data.w : null\n}\n\nexport default getV\n","import getV from './getV'\n\nconst formatTime = time => {\n  const [ hour, minite ] = time.trim().split(':')\n  return parseInt(hour) * 60 + parseInt(minite) * 1\n}\nconst getLateData = ({ time, date, workDates }) => {\n  if (!workDates.includes(date)) {\n    return {\n      isLate: false,\n      late: 0\n    }\n  }\n\n  const limit = 4\n  const lateTime = formatTime(time)\n  const isLate = lateTime > limit\n\n  return {\n    isLate,\n    late: isLate ? (lateTime - limit) : 0\n  }\n}\nconst getOvertimeData = ({ time, date, workDates }) => {\n  if (!workDates.includes(date)) {\n    return {\n        isOvertime: false,\n        time: 0,\n        subsidyTime: 0\n    }\n  }\n\n  const subsidyLimit = 1.5 * 60 - 20 // 8点40后技术部有补贴\n  const overtimeLimit = 1 * 60 // 7点半后算加班\n  let overtime = formatTime(time) - overtimeLimit\n  const subsidyTime = overtime - subsidyLimit\n  const isOvertime = overtime > 0\n\n  if (overtime >= (2 * 60 + 10) && overtime <= (2 * 60 + 30)) {\n    overtime = 2 * 60 + 30;\n  }\n\n  return {\n    isOvertime,\n    time: overtime > 0 ? overtime : 0,\n    subsidyTime: subsidyTime > 0 ? subsidyTime : 0\n  }\n}\n\nconst format = (sheetData, workDates) => {\n  const start = 2\n  const end = sheetData['!range'].e.r\n\n  let result = {}\n\n  for (let i = start; i <= end; i++) {\n    let id = getV(sheetData[`B${i}`]),\n      name = getV(sheetData[`C${i}`]),\n      date = getV(sheetData[`D${i}`]),\n      timeType = getV(sheetData[`E${i}`]),\n      signIn = getV(sheetData[`H${i}`]),\n      signOff = getV(sheetData[`I${i}`]),\n      lateTime = getV(sheetData[`L${i}`]),\n      overtime = getV(sheetData[`O${i}`])\n\n    if (!result[id]) {\n      result[id] = {\n        id: id,\n        name: name,\n        department: '',\n        late: 0,\n        overtime: 0,\n        subsidy: 0,\n        data: {},\n        workDays: 0\n      }\n    }\n\n    result[id].data[date] = {\n      date: date,\n      timeType: timeType,\n      signIn: signIn,\n      signOff: signOff,\n      rawLateTime: lateTime,\n      overtime: overtime,\n      subsidy: 0,\n      subsidyTime: 0,\n      needWork: workDates.includes(date),\n      isWork: !!signOff\n    }\n\n    // 迟到\n    if (lateTime) {\n      const { isLate, late } = getLateData({\n        time: lateTime,\n        date,\n        workDates\n      })\n      result[id].data[date].isLate = isLate\n      result[id].data[date].late = late\n      result[id].late += late\n    }\n\n    if (workDates.includes(date) && (signIn || signOff)) {\n      result[id].workDays++;\n    }\n\n    // 加班\n    if (overtime) {\n      const { isOvertime, time, subsidyTime } = getOvertimeData({\n        time: overtime,\n        date,\n        workDates\n      })\n      const subsidyPerDay = 20\n      const subsidy = subsidyTime > 0 ? subsidyPerDay : 0\n\n      result[id].data[date].isOvertime = isOvertime\n      result[id].data[date].overtime = time\n      result[id].data[date]._subsidyTime = subsidyTime\n      result[id].data[date]._subsidy = subsidy\n      result[id].overtime += time\n    }\n  }\n\n  return result\n}\n\nexport default format\n","import getV from './getV'\n\nconst format = (sheetData) => {\n  const end = +sheetData['!ref'].split(':')[1].replace(/\\D+/g, '')\n  const start = 2\n  const result = []\n\n  for (let i = start; i <= end; i++) {\n    let id = getV(sheetData[`C${i}`]),\n      name = getV(sheetData[`B${i}`]),\n      department = getV(sheetData[`E${i}`]),\n      group = getV(sheetData[`F${i}`])\n\n    if (name) {\n      name = name.trim()\n    }\n\n    result.push({\n      id,\n      name,\n      department,\n      group\n    })\n  }\n\n  return result\n}\n\nexport default format\n","const getDepartment = data => {\n  return data ? data.department : ''\n}\nconst getGroup = data => {\n  return data ? data.group : ''\n}\n\nconst getDepartmentInfo = ({ id, name, data }) => {\n  let department, group;\n  const staffInfo = data.find((item) => {\n    if (name == '刘莉') {\n      return item.name === name && item.id === id;\n    } else {\n      return item.name === name;\n    }\n  });\n\n  department = getDepartment(staffInfo);\n  group = getGroup(staffInfo);\n\n  return {\n    department,\n    group\n  }\n};\n\nconst format = (result, result2) => {\n  let result3 = {}\n  let total = 0\n\n  for (let id in result) {\n    const name = result[id].name;\n    let { department, group } = getDepartmentInfo({ id, name, data: result2})\n    group = group || department\n\n    result[id].department = department\n    result[id].group = group\n\n    if (department === '技术部') {\n      for (let date in result[id].data) {\n        let subsidy = result[id].data[date]._subsidy\n        let subsidyTime = result[id].data[date]._subsidyTime\n\n        if (subsidy > 0) {\n          result[id].data[date].subsidy = subsidy\n          result[id].data[date].subsidyTime = subsidyTime\n          result[id].subsidy += subsidy\n          result[id].subsidyTime += subsidyTime\n        }\n      }\n    } else {\n      result[id].overtime = 0;\n    }\n\n    if (!result3[department]) {\n      result3[department] = {\n        count: 0\n      }\n    }\n\n    if (!result3[department][group]) {\n      result3[department][group] = {\n        count: 0\n      }\n    }\n\n    result3[department][group][id] = result[id]\n    result3[department].count++\n    result3[department][group].count++\n    total++\n  }\n\n  return {\n    total,\n    data: result3\n  }\n}\n\nexport default format\n","const createCurrentMonthData = () => {\n  const today = new Date()\n  const fullYear = today.getFullYear()\n  const year = fullYear.toString().slice(-2)\n  const month = today.getMonth() + 1;\n  const fullMonth = month < 10 ? `0${month}` : month\n  const last = (new Date(year, month, 0)).getDate()\n\n  return {\n    fullYear,\n    year,\n    fullMonth,\n    month,\n    last\n  }\n}\nconst createLabelName = n => {\n  let s = ''\n  let number = parseInt(n)\n  while (number > 0) {\n    let m = number % 26\n\n    if (m == 0) {\n      m = 26\n    }\n\n    s = String.fromCharCode(m + 64) + s\n    number = (number - m) / 26\n  }\n  return s\n}\n\nexport {\n  createCurrentMonthData,\n  createLabelName\n}","import {\n  createCurrentMonthData,\n  createLabelName\n} from './generateUtils'\n\nconst generateSheet1 = (result3, total, workDates, isCalcWorkDays) => {\n  const workDays = workDates.length;\n  const { year, month, last: lastDay, fullMonth, fullYear } = createCurrentMonthData()\n  const sheet2LastLabel = createLabelName(lastDay + 3)\n  const generate = (result3, total, workDays, isCalcWorkDays) => {\n    let merges = [\n      {\n        s: { c: 0, r: 0 },\n        e: { c: 18, r: 0 }\n      }, {\n        s: { c: 0, r: 1 },\n        e: { c: 18, r: 1 }\n      }\n    ]\n    let wbData = {}\n    const wbData2 = {}\n    const wbData3 = {}\n    let departmentMerge = 3\n    let groupMerge = 3\n    let no = 1\n    let noIndex = 4\n\n    const generateSheet1Data = (item) => {\n      wbData[`A${noIndex}`] = {\n        v: no,\n        t: 'n',\n        s: {\n          alignment: {\n            vertical: 'center',\n            horizontal: 'center'\n          }\n        }\n      }\n\n      wbData[`D${noIndex}`] = {\n        v: `${item.name}`,\n        t: 's',\n        s: {\n          alignment: {\n            vertical: 'center',\n            horizontal: 'center'\n          }\n        }\n      }\n\n      wbData[`E${noIndex}`] = {\n        v: item.workDays,\n        t: 'n',\n        s: {\n          alignment: {\n            vertical: 'center',\n            horizontal: 'center'\n          }\n        }\n      }\n\n      wbData[`F${noIndex}`] = {\n        v: `${(isCalcWorkDays && item.workDays === workDays) ? '√' : ''}`,\n        t: 's',\n        s: {\n          alignment: {\n            vertical: 'center',\n            horizontal: 'center'\n          }\n        }\n      }\n\n      if (item.subsidy) {\n        wbData[`G${noIndex}`] = {\n          v: `${item.subsidy}元`,\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'center',\n              horizontal: 'center'\n            }\n          }\n        }\n      }\n\n      if (item.overtime) {\n        wbData[`H${noIndex}`] = {\n          v: `${item.overtime}分钟`,\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'center',\n              horizontal: 'center'\n            }\n          }\n        }\n      }\n\n      if (item.late) {\n        wbData[`I${noIndex}`] = {\n          v: `${item.late}分钟`,\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'center',\n              horizontal: 'center'\n            }\n          }\n        }\n\n        const note = Object.entries(item.data).reduce((note, [time, { late }]) => {\n          const [year, month, date] = time.trim().split('/')\n\n          if (late) {\n            note += `${date}日迟到${late}分钟，`;\n          }\n          return note;\n        }, '迟到：');\n\n        wbData[`R${noIndex}`] = {\n          v: note,\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'center',\n              horizontal: 'center',\n              wrapText: true,\n            }\n          }\n        }\n      }\n    }\n    const generateSheet2Data = item => {\n      const index = noIndex - 1\n\n      wbData2[`A${index}`] = {\n        v: `${item.name}`,\n        t: 's',\n        s: {\n          alignment: {\n            vertical: 'center',\n            horizontal: 'center'\n          },\n          fill: {\n            fgColor: {\n              rgb: 'FF9FCD63'\n            }\n          }\n        }\n      }\n\n      if (item.late != null) {\n        wbData2[`${sheet2LastLabel}${index}`] = {\n          v: item.late,\n          t: 'n',\n          s: {\n            alignment: {\n              vertical: 'center',\n              horizontal: 'center'\n            }\n          }\n        }\n      }\n\n      Object.entries(item.data).forEach(([time, { late }]) => {\n        const date = +time.split('/')[2]\n\n        if (late) {\n          wbData2[`${createLabelName(date + 1)}${index}`] = {\n            v: late,\n            t: 'n',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          }\n        }\n      })\n    }\n    const generateSheet3Data = item => {\n      const index = noIndex - 1\n\n      wbData3[`A${index}`] = {\n        v: `${item.name}`,\n        t: 's',\n        s: {\n          alignment: {\n            vertical: 'center',\n            horizontal: 'center'\n          },\n          fill: {\n            fgColor: {\n              rgb: 'FF9FCD63'\n            }\n          }\n        }\n      }\n    }\n\n    for (let department in result3) {\n      for (let key in result3[department]) {\n        let value = result3[department][key]\n\n        if (key == 'count') {\n          merges.push(\n            {\n              s: { c: 1, r: departmentMerge },\n              e: { c: 1, r: departmentMerge + value - 1 }\n            }\n          )\n\n          wbData[`B${departmentMerge + 1}`] = {\n            v: department,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          }\n          departmentMerge += value\n        } else {\n          let group = key\n\n          for (let key2 in value) {\n            let value2 = value[key2]\n\n            if (key2 === 'count') {\n              merges.push(\n                {\n                  s: { c: 2, r: groupMerge },\n                  e: { c: 2, r: groupMerge + value2 - 1 }\n                }\n              )\n\n              wbData[`C${groupMerge + 1}`] = {\n                v: group,\n                t: 's',\n                s: {\n                  alignment: {\n                    vertical: 'center',\n                    horizontal: 'center'\n                  }\n                }\n              }\n              groupMerge += value2\n            } else {\n              generateSheet1Data(value2)\n              generateSheet2Data(value2)\n              generateSheet3Data(value2)\n\n              no++\n              noIndex++\n            }\n          }\n        }\n      }\n    }\n\n    for (let i = 1; i <= lastDay; i++) {\n      const timeLabel = `${year}.${month}.${i}`;\n      const rowName = createLabelName(i + 1);\n      wbData2[`${rowName}2`] = {\n        v: timeLabel,\n        t: 's',\n        s: {\n          alignment: {\n            vertical: 'center',\n            horizontal: 'center'\n          }\n        }\n      }\n\n      // 非工作日\n      if (!workDates.map((item => {\n        return item.slice(2).replace(/\\//g, '.');\n      })).includes(timeLabel)) {\n        for (let j = 2; j <= no; j++) {\n          const value = j === 2 ? timeLabel : '';\n          wbData2[`${rowName}${j}`] = {\n            v: value,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              },\n              fill: {\n                fgColor: {\n                  rgb: 'FFC8D5A1'\n                }\n              }\n            }\n          }\n        }\n      }\n\n      wbData3[`${rowName}2`] = {\n        v: timeLabel,\n        t: 's',\n        s: {\n          alignment: {\n            vertical: 'center',\n            horizontal: 'center'\n          }\n        }\n      }\n    }\n\n    wbData2[`${sheet2LastLabel}2`] = {\n      v: '总计（分钟）',\n      t: 's',\n      s: {\n        alignment: {\n          vertical: 'center',\n          horizontal: 'center'\n        }\n      }\n    }\n    wbData3[`${sheet2LastLabel}2`] = {\n      v: '总计（小时）',\n      t: 's',\n      s: {\n        alignment: {\n          vertical: 'center',\n          horizontal: 'center'\n        }\n      }\n    }\n\n    merges.push({\n      s: { c: 0, r: total + 3 },\n      e: { c: 18, r: total + 3 }\n    });\n\n    let sheet1Cols = []\n    for (let i = 1; i <= 19; i++) {\n      sheet1Cols.push({\n        wpx: 95\n      })\n    }\n\n    return {\n      SheetNames: ['汇总', '明细', '休病假'],\n      Sheets: {\n        '汇总': {\n          '!ref': `A1:S${total + 4}`,\n          '!merges': merges,\n          '!cols': sheet1Cols,\n          ...wbData,\n          A1: {\n            v: `广州汉风科技有限公司考勤表（${month}月份）`,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              },\n              font: {\n                sz: '18'\n              }\n            }\n          },\n          A2: {\n            v: `              负责人签字:                       ${fullYear}/${month}/${lastDay}`,\n            t: 's',\n            s: {\n              alignment: {\n                horizontal: 'top'\n              },\n              font: {\n                sz: '10'\n              }\n            }\n          },\n          A3: {\n            v: '序号',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          [`A${total + 4}`]: {\n            v: '备注：每月每人100元全勤奖励（已经走邮件批复）。',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n              }\n            }\n          },\n          B3: {\n            v: '部门',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          C3: {\n            v: '组别',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          D3: {\n            v: '姓名',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          E3: {\n            v: '出勤',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          F3: {\n            v: '全勤',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          G3: {\n            v: '餐补',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          H3: {\n            v: '加班',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          I3: {\n            v: `${month}月累计迟到`,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          J3: {\n            v: '上班未打卡',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          K3: {\n            v: `${month}月累计早退`,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          L3: {\n            v: '下班未打卡',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          M3: {\n            v: `${month}月累计旷工`,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          N3: {\n            v: `${month}月累计事假`,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          O3: {\n            v: `${month}月累计病假`,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          P3: {\n            v: `${month}月累计年假`,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          Q3: {\n            v: `${month}月累计有薪假`,\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          R3: {\n            v: '备注',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          S3: {\n            v: '员工签名',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          }\n        },\n\n        '明细': {\n          '!ref': `A1:${sheet2LastLabel}${total + 2}`,\n          '!merges': [\n            {\n              s: { c: 0, r: 0 },\n              e: { c: lastDay + 2, r: 0 }\n            }\n          ],\n          A1: {\n            v: '广州汉风员工迟到登记表',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          ...wbData2\n        },\n\n        '休病假': {\n          '!ref': `A1:${sheet2LastLabel}${total + 2}`,\n          '!merges': [\n            {\n              s: { c: 0, r: 0 },\n              e: { c: lastDay + 2, r: 0 }\n            }\n          ],\n          A1: {\n            v: '广州汉风员工休病假登记表',\n            t: 's',\n            s: {\n              alignment: {\n                vertical: 'center',\n                horizontal: 'center'\n              }\n            }\n          },\n          ...wbData3\n        }\n      }\n    }\n  };\n  const departmentSheet = Object.entries(result3).reduce((departmentSheet, [department, groups]) => {\n    const sheetName = department == '' ? '已离职员工' : department;\n    const obj = {\n      [department]: groups\n    };\n    departmentSheet.push({\n      sheet: generate(obj, total, workDays, isCalcWorkDays),\n      name: `汉风科技${sheetName}${month}月考勤表`\n    });\n    return departmentSheet;\n  }, []);\n\n  return {\n    sheet1: generate(result3, total, workDays, isCalcWorkDays),\n    departmentSheet\n  }\n}\n\nexport default generateSheet1\n","import {\n  createCurrentMonthData,\n  createLabelName\n} from './generateUtils'\n\nconst generateSheet2 = (result3) => {\n  let sheet4Merges = []\n  const wbData4 = {}\n  let techCount = 0\n  const { year, month, last: lastDay, fullMonth, fullYear } = createCurrentMonthData()\n  const generateSheet4Data = item => {\n    const no = techCount + 1\n    const index = techCount + 6\n\n    wbData4[`A${index}`] = {\n      v: no,\n      t: 'n',\n      s: {\n        alignment: {\n          horizontal: 'center'\n        }\n      }\n    }\n\n    wbData4[`B${index}`] = {\n      v: `${item.name}`,\n      t: 's',\n      s: {\n        alignment: {\n          horizontal: 'center'\n        }\n      }\n    }\n\n    sheet4Merges.push({\n      s: { c: 1, r: techCount + 5 },\n      e: { c: 2, r: techCount + 5 }\n    })\n\n    wbData4[`${createLabelName(lastDay + 4)}${index}`] = {\n      v: parseFloat(`${(item.overtime / 60).toFixed(1)}`),\n      t: 'n',\n      s: {\n        alignment: {\n          horizontal: 'center'\n        }\n      }\n    }\n\n    if (item.subsidy > 0) {\n      wbData4[`${createLabelName(lastDay + 5)}${index}`] = {\n        v: `${(item.subsidy).toFixed(0)}元`,\n        t: 's',\n        s: {\n          alignment: {\n            horizontal: 'center'\n          }\n        }\n      }\n    }\n\n    Object.entries(item.data).forEach(([time, { overtime, signOff }]) => {\n      const date = +time.split('/')[2]\n\n      if (overtime != null && overtime > 0) {\n        let s = {\n          s: {\n            alignment: {\n              horizontal: 'center',\n              wrapText: true,\n            }\n          }\n        }\n\n        if (overtime <= 60) {\n          s.s.font = {\n            color: {\n              rgb: 'FFFF0000'\n            }\n          }\n        }\n\n        wbData4[`${createLabelName(date + 3)}${index}`] = {\n          v: `${(overtime / 60).toFixed(1)}（${signOff}）`,\n          t: 's',\n          ...s\n        }\n      }\n    })\n  }\n\n  for (let department in result3) {\n    for (let key in result3[department]) {\n      let value = result3[department][key]\n\n      if (key == 'count') {\n\n      } else {\n        for (let key2 in value) {\n          let value2 = value[key2]\n\n          if (key2 === 'count') {\n          } else {\n            if (department == '技术部') {\n              generateSheet4Data(value2)\n              techCount++\n            }\n          }\n        }\n      }\n    }\n  }\n\n  for (let i = 1; i <= lastDay; i++) {\n    wbData4[`${createLabelName(i + 3)}5`] = {\n      v: `${i}日`,\n      t: 's',\n      s: {\n        alignment: {\n          horizontal: 'center'\n        }\n      }\n    }\n  }\n\n  let sheet4Cols = []\n  for (let i = 1; i <= lastDay + 5; i++) {\n    let wpx = i >= lastDay + 4 ? 90 : 40\n\n    sheet4Cols.push({\n      wpx\n    })\n  }\n\n  return {\n    SheetNames: ['Sheet1'],\n    Sheets: {\n      'Sheet1': {\n        '!ref': `A1:${createLabelName(lastDay + 5)}${techCount + 14}`,\n        '!cols': sheet4Cols,\n        '!merges': [\n          {\n            s: { c: 0, r: 0 },\n            e: { c: lastDay + 4, r: 1 }\n          },\n          {\n            s: { c: 0, r: 2 },\n            e: { c: 12, r: 2 }\n          },\n          {\n            s: { c: 13, r: 2 },\n            e: { c: lastDay - 1, r: 2 }\n          },\n          {\n            s: { c: 3, r: 3 },\n            e: { c: lastDay + 4, r: 3 }\n          },\n          {\n            s: { c: lastDay, r: 2 },\n            e: { c: lastDay + 4, r: 2 }\n          },\n          {\n            s: { c: 0, r: techCount + 5 },\n            e: { c: lastDay + 4, r: techCount + 7 }\n          },\n          {\n            s: { c: lastDay + 3, r: techCount + 8 },\n            e: { c: lastDay + 4, r: techCount + 10 }\n          },\n          {\n            s: { c: 0, r: techCount + 8 },\n            e: { c: lastDay + 2, r: techCount + 10 }\n          },\n          {\n            s: { c: 0, r: techCount + 11 },\n            e: { c: 12, r: techCount + 13 }\n          },\n          {\n            s: { c: lastDay, r: techCount + 11 },\n            e: { c: lastDay + 4, r: techCount + 13 }\n          },\n          {\n            s: { c: 13, r: techCount + 11 },\n            e: { c: lastDay - 1, r: techCount + 13 }\n          },\n          ...sheet4Merges\n        ],\n        'A1': {\n          v: '加班申请表',\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'center',\n              horizontal: 'center'\n            }\n          }\n        },\n        'A3': {\n          v: '申请部门：技术部',\n          t: 's'\n        },\n        'N3': {\n          v: '申请人：李冬杰',\n          t: 's'\n        },\n        [`${createLabelName(lastDay + 1)}3`]: {\n          v: `申请日期：${fullYear}${fullMonth}01-${fullMonth}${lastDay - 1}`,\n          t: 's',\n          s: {\n            alignment: {\n              horizontal: 'center'\n            }\n          }\n        },\n        'D4': {\n          v: `${fullYear}年${month}月`,\n          t: 's',\n          s: {\n            alignment: {\n              horizontal: 'center'\n            }\n          }\n        },\n        [`${createLabelName(lastDay + 4)}5`]: {\n          v: '合计（小时）',\n          t: 's',\n          s: {\n            alignment: {\n              horizontal: 'center'\n            }\n          }\n        },\n        [`${createLabelName(lastDay + 5)}5`]: {\n          v: '餐补（元）',\n          t: 's',\n          s: {\n            alignment: {\n              horizontal: 'center'\n            }\n          }\n        },\n        [`A${techCount + 6}`]: {\n          v: '加班原因（具体工作内容）：',\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'top'\n            }\n          }\n        },\n        [`${createLabelName(lastDay + 4)}${techCount + 9}`]: {\n          v: '申请人签字：  ',\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'top'\n            }\n          }\n        },\n        [`A${techCount + 12}`]: {\n          v: '部门负责人审批：                    ',\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'top'\n            }\n          }\n        },\n        [`N${techCount + 12}`]: {\n          v: '行政部：                 ',\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'top'\n            }\n          }\n        },\n        [`${createLabelName(lastDay + 1)}${techCount + 12}`]: {\n          v: '总经理：                    ',\n          t: 's',\n          s: {\n            alignment: {\n              vertical: 'top'\n            }\n          }\n        },\n        ...wbData4\n      }\n    }\n  }\n}\n\nexport default generateSheet2\n","import generateSheet1 from './generateSheet1'\nimport generateSheet2 from './generateSheet2'\n\nconst generate = (result3, total, workDates, isCalcWorkDays) => {\n  const { sheet1, departmentSheet } = generateSheet1(result3, total, workDates, isCalcWorkDays);\n  return {\n    sheet1,\n    departmentSheet,\n    sheet2: generateSheet2(result3),\n  }\n};\n\nexport default generate;","const saveAs = (obj, fileName) => {\n  const a = document.createElement('a')\n  a.download = fileName || '下载'\n  a.href = URL.createObjectURL(obj)\n  a.click()\n  setTimeout(() => {\n    URL.revokeObjectURL(obj)\n  }, 100)\n}\n\nconst s2ab = s => {\n  let buf = new ArrayBuffer(s.length)\n  let view = new Uint8Array(buf)\n  for (let i = 0; i !== s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF\n  return buf\n}\n\nconst save = ({ name = '', data = [] }) => {\n  const zip = new JSZip()\n\n  data.forEach(({ name, sheet }) => {\n    const workbookOut = XLSX.write(sheet, {\n      bookType: 'xlsx',\n      bookSST: false,\n      type: 'binary'\n    })\n\n    zip.file(`${name}.xlsx`, new Blob([s2ab(workbookOut)], {\n      type: 'application/octet-stream'\n    }));\n  });\n\n  zip.generateAsync({ type: \"blob\" }).then(function (blob) {\n    saveAs(blob, name);\n  }, function (err) {\n    console.log(err);\n  });\n}\n\nexport default save\n","<template>\n  <div id=\"app\">\n    <el-row :gutter=\"20\">\n      <el-col :span=\"8\">\n        <el-card class=\"box-card\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>选择工作日期</span>\n          </div>\n          <div class=\"text item\">\n            <el-date-picker\n              type=\"dates\"\n              v-model=\"dates\"\n              size=\"large\"\n              placeholder=\"选择工作日\">\n            </el-date-picker>\n            <el-checkbox v-model=\"isCalcWorkDays\" style=\"margin-left: 20px;\">显示全勤</el-checkbox>\n          </div>\n        </el-card>\n      </el-col>\n      <el-col :span=\"8\">\n        <el-card class=\"box-card\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>上传报表</span>\n          </div>\n          <div class=\"text item\">\n            <el-upload\n              class=\"upload-item\"\n              action=\"\"\n              :on-change=\"onUploadChange1\"\n              :auto-upload=\"false\">\n              <el-button slot=\"trigger\" size=\"medium\" type=\"primary\">选取考勤报表（请确保后缀名是 xls）</el-button>\n            </el-upload>\n            <el-upload\n              class=\"upload-item\"\n              action=\"\"\n              :on-change=\"onUploadChange2\"\n              :auto-upload=\"false\">\n              <el-button slot=\"trigger\" size=\"medium\" type=\"primary\">选取员工花名册（请确保后缀名是 xlsx）</el-button>\n            </el-upload>\n            <el-button size=\"medium\" type=\"primary\" @click=\"onStart\" :disabled=\"isProcessing\">开始生成</el-button>\n            <div style=\"margin-top: 60px\" v-if=\"isFinish\">\n              <el-button size=\"medium\" type=\"primary\" @click=\"downloadSummarySheet\">下载总表</el-button>\n              <el-button size=\"medium\" type=\"primary\" @click=\"downloadDepartmentSheet\">下载部门表</el-button>\n            </div>\n          </div>\n        </el-card>\n      </el-col>\n      <el-col :span=\"8\">\n        <el-card class=\"box-card\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>注意事项</span>\n          </div>\n          <div class=\"text item\">\n            1、检查数据正确性\n          </div>\n          <div class=\"text item\">\n            2、修改时间\n          </div>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport getSheetData from '@/utils/getSheetData'\nimport formatSheet1 from '@/utils/formatSheet1'\nimport formatSheet2 from '@/utils/formatSheet2'\nimport updateDepartment from '@/utils/updateDepartment'\nimport generateSheet from '@/utils/generateSheet'\nimport save from '@/utils/save'\n\nconst today = new Date();\n\nexport default {\n  name: 'app',\n\n  data () {\n    return {\n      dates: [],\n      file1: null,\n      file2: null,\n      sheet1: null,\n      sheet2: null,\n      departmentSheet: null,\n      isFinish: false,\n      year: today.getFullYear(),\n      month: today.getMonth() + 1,\n      isCalcWorkDays: true,\n      isProcessing: false,\n    }\n  },\n\n  methods: {\n    onStart () {\n      if (this.dates.length === 0) {\n        this.$alert('请选择工作日期', '提醒', {\n          confirmButtonText: '确定',\n        });\n        return;\n      }\n\n      if (this.file1 == null) {\n        this.$alert('请上传考勤报表', '提醒', {\n          confirmButtonText: '确定',\n        });\n        return;\n      }\n\n      if (this.file2 == null) {\n        this.$alert('请上传花名册', '提醒', {\n          confirmButtonText: '确定',\n        });\n        return;\n      }\n\n      if (this.isProcessing) {\n        return;\n      }\n\n      this.isProcessing = true;\n\n      const workDates = this.dates.map(date => {\n        return `${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()}`\n        // return `${date.getFullYear()}/11/${date.getDate()}`\n      })\n\n      Promise.all([\n        getSheetData(this.file1),\n        getSheetData(this.file2)\n      ]).then(([[sheetData1], [sheetData2]]) => {\n        let data1 = formatSheet1(sheetData1, workDates)\n        let data2 = formatSheet2(sheetData2)\n        let { total, data: data3 } = updateDepartment(data1, data2)\n        let { sheet1, departmentSheet, sheet2 } = generateSheet(data3, total, workDates, this.isCalcWorkDays)\n\n        this.sheet1 = sheet1\n        this.sheet2 = sheet2\n        this.departmentSheet = departmentSheet\n        this.isFinish = true\n        this.isProcessing = false\n      });\n    },\n\n    onUploadChange1 (file, fileList) {\n      this.file1 = file.raw\n    },\n\n    onUploadChange2 (file, fileList) {\n      this.file2 = file.raw\n    },\n\n    downloadSummarySheet () {\n      save({\n        name: `广州汉风---员工考勤总表${this.year}年${this.month}月份`,\n        data: [\n          {\n            sheet: this.sheet1,\n            name: `广州汉风---员工考勤表${this.year}年${this.month}月份`\n          }, {\n            sheet: this.sheet2,\n            name: `技术部${this.month}月加班申请表`\n          }\n        ]\n      })\n    },\n\n    downloadDepartmentSheet () {\n      save({\n        name: `广州汉风---部门考勤总表${this.year}年${this.month}月份`,\n        data: this.departmentSheet\n      })\n    },\n  }\n}\n</script>\n\n<style>\n  .upload-item {\n    margin-bottom: 20px;\n  }\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=c943abd8&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"App.vue\"\nexport default component.exports","import Vue from 'vue'\nimport Element from 'element-ui'\nimport 'element-ui/lib/theme-chalk/index.css'\n\nVue.use(Element)\n","import Vue from 'vue'\nimport App from './App.vue'\n// import router from './router'\n// import store from './store'\n// import './registerServiceWorker'\nimport './plugins/element.js'\n\nVue.config.productionTip = false\n\nnew Vue({\n  // router,\n  // store,\n  render: h => h(App)\n}).$mount('#app')\n"],"sourceRoot":""}